# Work REST API ğŸš€

**Nowoczesne REST API do zarzÄ…dzania pracownikami i sprzedaÅ¼Ä… z automatycznym generowaniem raportÃ³w PDF**

![Go](https://img.shields.io/badge/Go-1.24-00ADD8?style=for-the-badge&logo=go)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-Latest-336791?style=for-the-badge&logo=postgresql)
![Docker](https://img.shields.io/badge/Docker-Compose-2496ED?style=for-the-badge&logo=docker)
![Echo](https://img.shields.io/badge/Echo-v4-00ADD8?style=for-the-badge)

## ğŸ“‹ Spis treÅ›ci

- [FunkcjonalnoÅ›ci](#-funkcjonalnoÅ›ci)
- [Technologie](#-technologie)
- [Architektura](#-architektura)
- [Instalacja](#-instalacja)
- [UÅ¼ycie](#-uÅ¼ycie)
- [API Endpoints](#-api-endpoints)
- [PrzykÅ‚ady](#-przykÅ‚ady)
- [Testowanie](#-testowanie)
- [Dane testowe](#-dane-testowe)

## âœ¨ FunkcjonalnoÅ›ci

### ğŸ‘¥ ZarzÄ…dzanie pracownikami (CRUD)
- âœ… Dodawanie, edycja, usuwanie pracownikÃ³w
- âœ… Walidacja danych (email, dÅ‚ugoÅ›Ä‡ pÃ³l)
- âœ… Sprawdzanie unikalnoÅ›ci email
- âœ… Automatyczne timestamps (created_at, updated_at)

### ğŸ’° ZarzÄ…dzanie sprzedaÅ¼Ä… (CRUD)
- âœ… Dodawanie, edycja, usuwanie sprzedaÅ¼y
- âœ… ObsÅ‚uga rÃ³Å¼nych walut (PLN, EUR, USD)
- âœ… Walidacja cen (muszÄ… byÄ‡ > 0)
- âœ… **Elastyczne formaty dat** - obsÅ‚uga wielu formatÃ³w:
  - ISO 8601: `2025-01-15T10:30:00Z`
  - RFC 3339: `2025-01-15T10:30:00+01:00`
  - Polski format: `15.01.2025 10:30`
  - Europejski: `15-01-2025 10:30`
  - AmerykaÅ„ski: `01/15/2025 10:30`

### ğŸ“Š Raporty PDF
- âœ… **MiesiÄ™czne raporty** pracownikÃ³w
- âœ… **Kwartalne raporty** pracownikÃ³w
- âœ… Automatyczne generowanie PDF z gofpdf
- âœ… Statystyki: liczba sprzedaÅ¼y, suma przychodÃ³w
- âœ… SzczegÃ³Å‚owe tabele wszystkich transakcji

### ğŸ”’ BezpieczeÅ„stwo i walidacja
- âœ… Walidacja email (regex)
- âœ… Walidacja dÅ‚ugoÅ›ci pÃ³l
- âœ… Sprawdzanie unikalnoÅ›ci email
- âœ… Walidacja dat i przedziaÅ‚Ã³w czasowych
- âœ… Walidacja cen i walut

## ğŸ›  Technologie

| Komponent | Technologia | Wersja |
|-----------|-------------|---------|
| **Backend** | Go | 1.24 |
| **Framework** | Echo | v4 |
| **Baza danych** | PostgreSQL | Latest |
| **ORM/Query Builder** | sqlc | Latest |
| **PoÅ‚Ä…czenie DB** | pgx/v5 | v5.7.5 |
| **PDF Generator** | gofpdf | v1.4.3 |
| **Konteneryzacja** | Docker + Docker Compose | Latest |

## ğŸ— Architektura

```
WorkRESTAPI/
â”œâ”€â”€ cmd/api/                    # Punkt wejÅ›cia aplikacji
â”‚   â””â”€â”€ main.go
â”œâ”€â”€ internal/                   # Logika biznesowa
â”‚   â”œâ”€â”€ db.go                   # PoÅ‚Ä…czenie z bazÄ…
â”‚   â”œâ”€â”€ models.go               # Modele danych
â”‚   â”œâ”€â”€ query.sql.go            # Wygenerowane zapytania (sqlc)
â”‚   â””â”€â”€ server/                 # Serwer HTTP
â”‚       â”œâ”€â”€ routes.go           # Endpointy API + logika
â”‚       â””â”€â”€ routes_test.go      # Testy jednostkowe
â”œâ”€â”€ migrations/                 # Migracje bazy danych
â”œâ”€â”€ schema.sql                  # Schemat bazy danych
â”œâ”€â”€ query.sql                   # Definicje zapytaÅ„ SQL
â”œâ”€â”€ test_data.sql              # Dane testowe
â”œâ”€â”€ docker-compose.yml         # Orkiestracja kontenerÃ³w
â”œâ”€â”€ Dockerfile                 # Obraz aplikacji
â””â”€â”€ sqlc.yaml                  # Konfiguracja sqlc
```

## ğŸš€ Instalacja

### Wymagania
- Docker & Docker Compose
- Go 1.24+ (opcjonalnie, do developmentu)

### Krok 1: Sklonuj repozytorium
```bash
git clone <repository-url>
cd WorkRESTAPI
```

### Krok 2: UtwÃ³rz plik Å›rodowiskowy
```bash
# Skopiuj przykÅ‚adowy plik konfiguracyjny
cp .env.example .env
```

Edytuj `.env`:
```env
PORT=1323
APP_ENV=production
DB_HOST=db
DB_USERNAME=postgres
DB_PASSWORD=secretpassword
DB_DATABASE=workrestapi
DB_PORT=5432
DB_SCHEMA=public
```

### Krok 3: Uruchom z danymi testowymi
```bash
# Odkomentuj liniÄ™ w docker-compose.yml dla automatycznego Å‚adowania danych
# - ./test_data.sql:/docker-entrypoint-initdb.d/02-test-data.sql

# Uruchom aplikacjÄ™
docker-compose up -d
```

### Krok 4: SprawdÅº czy dziaÅ‚a
```bash
# SprawdÅº pracownikÃ³w
curl http://localhost:1323/employees

# SprawdÅº sprzedaÅ¼e
curl http://localhost:1323/sales
```

## ğŸ’¡ UÅ¼ycie

### Uruchomienie
```bash
# Uruchom wszystkie serwisy
docker-compose up -d

# SprawdÅº logi
docker-compose logs -f app

# Zatrzymaj serwisy
docker-compose down
```

### Development
```bash
# Uruchom tylko bazÄ™ danych
docker-compose up -d db

# Uruchom aplikacjÄ™ lokalnie
go run cmd/api/main.go
```

## ğŸ“¡ API Endpoints

### ğŸ‘¥ Pracownicy

| Metoda | Endpoint | Opis |
|--------|----------|------|
| `GET` | `/employees` | Pobierz wszystkich pracownikÃ³w |
| `GET` | `/employee?id=1` | Pobierz pracownika po ID |
| `POST` | `/employee` | Dodaj nowego pracownika |
| `PUT` | `/employee/:id` | Zaktualizuj pracownika |
| `DELETE` | `/employee/:id` | UsuÅ„ pracownika |

### ğŸ’° SprzedaÅ¼e

| Metoda | Endpoint | Opis |
|--------|----------|------|
| `GET` | `/sales` | Pobierz wszystkie sprzedaÅ¼e |
| `GET` | `/sale?id=1` | Pobierz sprzedaÅ¼ po ID |
| `POST` | `/sale` | Dodaj nowÄ… sprzedaÅ¼ |
| `PUT` | `/sale/:id` | Zaktualizuj sprzedaÅ¼ |
| `DELETE` | `/sale/:id` | UsuÅ„ sprzedaÅ¼ |

### ğŸ“Š Raporty PDF

| Metoda | Endpoint | Opis |
|--------|----------|------|
| `GET` | `/employee/:id/report/month?year=2025&month=1` | Raport miesiÄ™czny PDF |
| `GET` | `/employee/:id/report/quarter?year=2025&quarter=1` | Raport kwartalny PDF |

## ğŸ”§ PrzykÅ‚ady

### Dodaj nowego pracownika
```bash
curl -X POST http://localhost:1323/employee \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Anna",
    "surname": "Kowalska",
    "email": "anna.kowalska@firma.pl"
  }'
```

### Dodaj sprzedaÅ¼ (z elastycznym formatem daty)
```bash
curl -X POST http://localhost:1323/sale \
  -H "Content-Type: application/json" \
  -d '{
    "product_name": "Laptop Dell",
    "category": "Electronics",
    "currency": "PLN",
    "price": 4500.00,
    "sale_date": "15.01.2025 10:30",
    "employee_id": 1
  }'
```

### Wygeneruj raport PDF
```bash
# MiesiÄ™czny raport pracownika ID=1 za styczeÅ„ 2025
curl "http://localhost:1323/employee/1/report/month?year=2025&month=1" \
  --output raport_styczen_2025.pdf

# Kwartalny raport pracownika ID=1 za Q1 2025
curl "http://localhost:1323/employee/1/report/quarter?year=2025&quarter=1" \
  --output raport_q1_2025.pdf
```

## ğŸ§ª Testowanie

### Uruchom testy jednostkowe
```bash
# Wszystkie testy
go test ./...

# Testy z pokryciem
go test -cover ./...

# Testy serwera
go test ./internal/server/
```

### Testy integracyjne
```bash
# Testowanie API (PowerShell)
.\test_api.ps1

# Testowanie API (Bash)
./test_api.sh
```

## ğŸ“Š Dane testowe

Projekt zawiera gotowe dane testowe (`test_data.sql`):

### ğŸ‘¥ 8 pracownikÃ³w
- Jan Kowalski, Anna Nowak, Piotr WiÅ›niewski, etc.
- RÃ³Å¼ne emaile firm polskich

### ğŸ’° 60+ sprzedaÅ¼y
- **RÃ³Å¼ne okresy**: styczeÅ„-lipiec 2025 + dane z 2024
- **RÃ³Å¼ne kategorie**: Electronics, Furniture, Software
- **RÃ³Å¼ne waluty**: PLN, EUR, USD
- **RÃ³Å¼ne ceny**: od 79.99 do 8999.00

### ğŸ“ˆ PrzykÅ‚adowe dane
```sql
-- Pracownik
('Jan', 'Kowalski', 'jan.kowalski@firma.pl')

-- SprzedaÅ¼e
('Laptop Dell XPS 13', 'Electronics', 'PLN', 4500.00, '2025-01-15 10:30:00+01:00', 1)
('Office 365', 'Software', 'EUR', 299.99, '2025-01-30 12:00:00+01:00', 8)
```

### Åadowanie danych testowych

**SposÃ³b 1: Automatyczne (zalecany)**
```yaml
# W docker-compose.yml dodaj:
- ./test_data.sql:/docker-entrypoint-initdb.d/02-test-data.sql
```

**SposÃ³b 2: RÄ™czne**
```bash
# ZaÅ‚aduj dane do dziaÅ‚ajÄ…cej bazy
docker exec -i workrestapi-db-1 psql -U postgres -d workrestapi < test_data.sql
```

## ğŸ” Funkcje zaawansowane

### Elastyczne daty
API automatycznie rozpoznaje i parsuje rÃ³Å¼ne formaty dat:
- `"2025-01-15T10:30:00Z"` (ISO 8601)
- `"15.01.2025 10:30"` (Polski)
- `"15-01-2025 10:30"` (Europejski)
- `"01/15/2025 10:30"` (AmerykaÅ„ski)

### Walidacje
- âœ… Email: regex pattern validation
- âœ… Ceny: muszÄ… byÄ‡ > 0
- âœ… Daty: sprawdzanie poprawnoÅ›ci
- âœ… UnikalnoÅ›Ä‡: email nie moÅ¼e siÄ™ powtarzaÄ‡

### Raporty PDF
- ğŸ“Š Statystyki: liczba sprzedaÅ¼y, suma przychodÃ³w
- ğŸ“‹ Tabele: szczegÃ³Å‚owe dane wszystkich transakcji
- ğŸ“… Okresy: miesiÄ™czne i kwartalne
- ğŸ’¾ Auto-download: pliki PDF z nazwami pracownikÃ³w

## ğŸ› RozwiÄ…zywanie problemÃ³w

### Problem: BÅ‚Ä…d poÅ‚Ä…czenia z bazÄ…
```bash
# SprawdÅº czy baza jest uruchomiona
docker-compose ps

# SprawdÅº logi bazy
docker-compose logs db

# Restartuj serwisy
docker-compose restart
```

### Problem: Zmienne Å›rodowiskowe
```bash
# SprawdÅº czy plik .env istnieje
ls -la .env

# SprawdÅº czy zmienne sÄ… zaÅ‚adowane
docker-compose config
```

## ğŸ“ Licencja

MIT License - moÅ¼esz swobodnie uÅ¼ywaÄ‡, modyfikowaÄ‡ i dystrybuowaÄ‡.

---

**Autor**: TwÃ³j Nick  
**Ostatnia aktualizacja**: Lipiec 2025  
**Wersja**: 1.0.0

ğŸŒŸ **JeÅ›li projekt Ci siÄ™ podoba, zostaw gwiazdkÄ™!** â­
